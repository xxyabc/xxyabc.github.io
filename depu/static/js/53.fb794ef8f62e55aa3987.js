webpackJsonp([53],{SOQv:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("woOf"),l=r.n(a),o=r("1oBE"),s=Object(o.a)(),i={data:function(){return{myHeaders:{token:s},imgUrl:"",ruleForm:{title:"",title_en:"",deadline:"",startDate:"",endDate:"",roomPlayerCount:"",participantCount:"",thumbnail:"",top:!1,summary:"",summary_en:"",content:""},rules:{title:[{required:!0,message:"请输入赛事标题",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],title_en:[{required:!0,message:"请输入赛事英文标题",trigger:"blur"}],deadline:[{required:!0,message:"请选择报名截止日期",trigger:"change"}],startDate:[{type:"date",required:!0,message:"请选择开始时间",trigger:"change"}],endDate:[{type:"date",required:!0,message:"请选择结束时间",trigger:"change"}],roomPlayerCount:[{required:!0,message:"请至少选择一个房间人数",trigger:"change"}],participantCount:[{required:!0,message:"请输入可报名人数",trigger:"blur"}],thumbnail:[{required:!0,message:"请选择封面图片",trigger:"blur"}],top:[{required:!0,message:"请选择是否置顶",trigger:"change"}],summary:[{required:!0,message:"请填写赛事描述",trigger:"blur"}],summary_en:[{required:!0,message:"请填写赛事英文描述",trigger:"blur"}],content:[{required:!0,message:"请填写赛事内容",trigger:"blur"}]}}},mounted:function(){},methods:{getMyTime:function(e){return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())+".000"},backPeonyPage:function(){this.$router.push({name:"competitionAnnouncement"})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var r=t.ruleForm,a=l()({},r);a.deadline=t.getMyTime(new Date(a.deadline)),a.startDate=t.getMyTime(new Date(a.startDate)),a.endDate=t.getMyTime(new Date(a.endDate)),a.title=a.title+"##"+a.title_en,a.summary=a.summary+"##"+a.summary_en,console.log(a),t.$request.activityCreate(a).then(function(e){200==e.code?(t.$message({showClose:!0,message:"添加成功！",type:"success",duration:3e3}),t.$router.push({name:"competitionAnnouncement"})):t.$message({showClose:!0,message:"添加失败！",type:"error",duration:3e3})}).catch(function(e){t.$message({showClose:!0,message:"添加失败！",type:"error",duration:3e3})})}else t.$message({showClose:!0,message:"请检查信息填写的完整性！",type:"error",duration:3e3})})},resetForm:function(e){this.$refs[e].resetFields(),this.$message({showClose:!0,message:"信息重置成功！",type:"success",duration:3e3})},handleAvatarSuccess:function(e,t){"SUCCESS"==e.state?this.ruleForm.thumbnail=e.url:(this.$message.error("文件上传失败，请稍后重试！"),this.ruleForm.thumbnail="")},handleError:function(e,t){this.$message.error("文件上传失败，请稍后重试！")},handleRemove:function(e){this.signinForm.aiPackage=""},beforeAvatarUpload:function(e){this.ruleForm.thumbnail=e,console.log(this.ruleForm.thumbnail);var t=window.URL||window.webkitURL;this.imgUrl=t.createObjectURL(e);var r="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type,a=e.size/1024/1024<2;return r||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&a}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"addAnnouncement",attrs:{id:"addAnnouncement"}},[r("fei-bread",[e._v("\n    赛事公告\n    "),r("i",{staticClass:"el-icon-d-arrow-right"}),e._v(" "),r("span",{staticClass:"current-text"},[e._v("添加赛事")])]),e._v(" "),r("el-card",{staticClass:"card"},[r("div",{staticClass:"card-div"},[r("p",{staticClass:"backPeony"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-back"},on:{click:e.backPeonyPage}},[e._v("返回上一级")])],1),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"赛事标题",prop:"title"}},[r("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"赛事英文标题",prop:"title_en"}},[r("el-input",{model:{value:e.ruleForm.title_en,callback:function(t){e.$set(e.ruleForm,"title_en",t)},expression:"ruleForm.title_en"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"报名截止日期",prop:"deadline"}},[r("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,placeholder:"选择日期时间"},model:{value:e.ruleForm.deadline,callback:function(t){e.$set(e.ruleForm,"deadline",t)},expression:"ruleForm.deadline"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"活动时间",required:""}},[r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"startDate"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.ruleForm.startDate,callback:function(t){e.$set(e.ruleForm,"startDate",t)},expression:"ruleForm.startDate"}})],1)],1),e._v(" "),r("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"endDate"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间"},model:{value:e.ruleForm.endDate,callback:function(t){e.$set(e.ruleForm,"endDate",t)},expression:"ruleForm.endDate"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"每个房间开始人数",prop:"roomPlayerCount"}},[r("el-radio-group",{attrs:{size:"mini"},model:{value:e.ruleForm.roomPlayerCount,callback:function(t){e.$set(e.ruleForm,"roomPlayerCount",t)},expression:"ruleForm.roomPlayerCount"}},[r("el-radio",{attrs:{label:2,border:""}},[e._v("2")]),e._v(" "),r("el-radio",{attrs:{label:3,border:""}},[e._v("3")]),e._v(" "),r("el-radio",{attrs:{label:4,border:""}},[e._v("4")]),e._v(" "),r("el-radio",{attrs:{label:5,border:""}},[e._v("5")]),e._v(" "),r("el-radio",{attrs:{label:6,border:""}},[e._v("6")])],1)],1),e._v(" "),r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"可报名人数",prop:"participantCount"}},[r("el-input",{model:{value:e.ruleForm.participantCount,callback:function(t){e.$set(e.ruleForm,"participantCount",t)},expression:"ruleForm.participantCount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"赛事封面",prop:"thumbnail"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.$global.baseUrl2+"/file/upload",headers:e.myHeaders,name:"upfile","show-file-list":!1,"on-success":e.handleAvatarSuccess,"on-error":e.handleError,"on-remove":e.handleRemove,accept:"image/png, image/jpg, image/jpeg","before-upload":e.beforeAvatarUpload}},[e.imgUrl?r("img",{staticClass:"avatar",attrs:{src:e.imgUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"是否置顶",prop:"top"}},[r("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.ruleForm.top,callback:function(t){e.$set(e.ruleForm,"top",t)},expression:"ruleForm.top"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"赛事描述",prop:"summary"}},[r("el-input",{model:{value:e.ruleForm.summary,callback:function(t){e.$set(e.ruleForm,"summary",t)},expression:"ruleForm.summary"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"赛事英文描述",prop:"summary_en"}},[r("el-input",{model:{value:e.ruleForm.summary_en,callback:function(t){e.$set(e.ruleForm,"summary_en",t)},expression:"ruleForm.summary_en"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"赛事内容",prop:"content"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])],1)},staticRenderFns:[]};var m=r("VU/8")(i,n,!1,function(e){r("i8p6")},"data-v-0dddae99",null);t.default=m.exports},i8p6:function(e,t){}});