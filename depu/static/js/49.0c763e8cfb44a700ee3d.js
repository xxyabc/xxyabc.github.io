webpackJsonp([49],{Km3q:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("1oBE"),i={name:"resetPassword",data:function(){return{email:"",sendLoading:!1,sendEmail:!1,activeTab:0,newPassword:"",confirmPassword:"",userMsg:{},count:10,timmer:null}},created:function(){window.location.href.indexOf("?")>-1?(this.activeTab=1,this.userMsg=this.$common.getRequest(window.location.href.split("?")[1]),console.log(this.userMsg)):this.activeTab=0},methods:{subEmail:function(){var e=this;""!=this.email?(this.sendLoading=!0,this.$request.resetPasswordEmail({email:this.email}).then(function(t){e.sendLoading=!1,console.log(t.data.code),"500"==t.data.code?e.$message({message:e.$gettext("该邮箱未注册！"),type:"error",duration:1500}):"200"==t.data.code&&(console.log(123),e.sendEmail=!0)}).catch(function(t){e.$message({message:e.$gettext("发送失败，请联系管理员"),type:"error",duration:1500}),e.sendLoading=!1})):this.$message({message:this.$gettext("请填写邮箱！"),type:"warning",duration:1500})},subPassword:function(){var e=this;this.newPassword===this.confirmPassword&&""!=this.password?this.$request.resetPassword({password:this.newPassword,userId:this.userMsg.userId,vlidateCode:this.userMsg.code}).then(function(t){console.log(t),"500"==t.data.code?e.$message({message:e.$gettext("邮箱验证已过期，请重新发送邮件！"),type:"warning",duration:1500}):"200"==t.data.code&&(e.activeTab=2,e.logOut(),e.timmer=setInterval(function(){0==e.count?(e.logOut(),e.$router.push({name:"login"}),clearInterval(e.timmer)):e.count--},1e3))}):this.$message({message:this.$gettext("两次密码不一致，请重新输入！"),type:"warning",duration:1500})},logOut:function(){this.$request.logout().then(function(e){console.log(e),Object(a.b)()}).catch(function(e){Object(a.b)()})}},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"resetPassword-box"},[s("ul",{staticClass:"tab"},[s("li",{class:{active:0==e.activeTab}},[e._v("1."+e._s(e.$gettext("确认账户")))]),e._v(" "),s("li",{class:{active:1==e.activeTab}},[e._v("2."+e._s(e.$gettext("修改登录密码")))]),e._v(" "),s("li",{class:{active:2==e.activeTab}},[e._v("3."+e._s(e.$gettext("修改成功")))])]),e._v(" "),0==e.activeTab?s("div",{staticClass:"content1"},[s("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.sendEmail,expression:"!sendEmail"}]},[s("el-col",{attrs:{span:6}},[s("label",[e._v(e._s(e.$gettext("您的登录邮箱：")))])]),e._v(" "),s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{placeholder:e.$gettext("请输入注册时的邮箱地址"),"prefix-icon":"el-icon-message"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),e._v(" "),s("el-button",{staticClass:"subEmail",attrs:{round:"",loading:e.sendLoading,type:"primary"},on:{click:e.subEmail}},[e._v(e._s(e.$gettext("提 交")))])],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.sendEmail,expression:"sendEmail"}],staticClass:"send-box"},[s("p",[e._v(e._s(e.$gettext("密码重置链接将发到您的登录邮箱："))),s("span",{staticStyle:{color:"#607CE1"}},[e._v(e._s(e.email))]),e._v(e._s(e.$gettext("，请注意查收！")))]),e._v(" "),s("p",[e._v("\n        "+e._s(e.$gettext("如未收到，请点击"))+"\n        "),s("a",{attrs:{href:"jacascript:;"},on:{click:e.subEmail}},[e._v(e._s(e.$gettext("重新发送邮件")))]),e._v("。\n      ")]),e._v(" "),s("p",[e._v(e._s(e.$gettext("收不到邮件？查看邮箱回收站、垃圾邮件。")))])])],1):1==e.activeTab?s("div",{staticClass:"content2"},[s("p",[e._v(e._s(e.$gettext("验证成功!请输入密码")))]),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.sendEmail,expression:"!sendEmail"}]},[s("el-col",{attrs:{span:6}},[s("label",[e._v(e._s(e.$gettext("新密码：")))])]),e._v(" "),s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{"show-password":"",placeholder:e.$gettext("请输入内容")},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.sendEmail,expression:"!sendEmail"}]},[s("el-col",{attrs:{span:6}},[s("label",[e._v(e._s(e.$gettext("确认密码"))+"：")])]),e._v(" "),s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{"show-password":"",placeholder:e.$gettext("请输入内容")},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1),e._v(" "),s("el-button",{staticClass:"subEmail",attrs:{loading:e.sendLoading,type:"success"},on:{click:e.subPassword}},[e._v(e._s(e.$gettext("确认修改")))])],1)],1):2==e.activeTab?s("div",{staticClass:"content3"},[s("p",[s("i",{staticClass:"el-icon-success"}),e._v(" "),s("span",[e._v(e._s(e.$gettext("恭喜，密码更改成功")))])]),e._v(" "),s("p",[e._v("\n      "+e._s(e.$gettext("您可以选择以下操作按钮，网站将在"))+"\n      "),s("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.count)+" ")]),e._v(e._s(e.$gettext("秒钟后返回登录页面"))+"\n      \n    ")]),e._v(" "),s("P",[s("el-button",{on:{click:e.logOut}},[e._v(e._s(e.$gettext("返回登录页面")))])],1)],1):e._e()])},staticRenderFns:[]};var o=s("VU/8")(i,n,!1,function(e){s("tZar")},"data-v-2bb1d9d7",null);t.default=o.exports},tZar:function(e,t){}});