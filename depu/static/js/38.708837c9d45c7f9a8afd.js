webpackJsonp([38],{"+Yc4":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=t("bOdI"),l=t.n(s),o=t("1oBE"),a=Object(o.a)(),n={data:function(){var e;return{myHeaders:{token:a},imgUrl:"",ruleForm:(e={name:"",name_en:"",desc:""},l()(e,"desc",""),l()(e,"resourceUrl",""),l()(e,"resourcePdfUrl",""),e),rules:{name:[{required:!0,message:"请输入资料标题",trigger:"blur"},{min:1,max:30,message:"长度在 1 到 30 个字符",trigger:"blur"}],name_en:[{required:!0,message:"请输入资料英文标题",trigger:"blur"}],resourceUrl:[{required:!0,message:"请上传文件",trigger:"blur"}],desc:[{required:!0,message:"请填写资料描述",trigger:"blur"}],desc_en:[{required:!0,message:"请填写资料英文描述",trigger:"blur"}]},uploadList:[],dlUploadList:[]}},mounted:function(){},methods:{getMyTime:function(e){return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())+".000"},backPeonyPage:function(){this.$router.push({name:"downloadManagement"})},submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(e){var t=r.ruleForm;t.name=t.name+"##"+t.name_en,t.desc=t.desc+"##"+t.desc_en,console.log(t),r.$request.addDownload(t).then(function(e){200==e.code?(r.$message({showClose:!0,message:"添加成功！",type:"success",duration:3e3}),r.$router.push({name:"downloadManagement"})):r.$message({showClose:!0,message:"添加失败！",type:"error",duration:3e3})}).catch(function(e){r.$message({showClose:!0,message:"添加失败！",type:"error",duration:3e3})})}else r.$message({showClose:!0,message:"请检查信息填写的完整性！",type:"error",duration:3e3})})},resetForm:function(e){this.$refs[e].resetFields(),this.$message({showClose:!0,message:"信息重置成功！",type:"success",duration:3e3})},handleAvatarSuccess:function(e,r,t){"SUCCESS"==e.state?this.ruleForm.resourcePdfUrl=e.url:(this.$message.error("文件上传失败，请稍后重试！"),this.ruleForm.resourcePdfUrl="",this.uploadList=[])},handleError:function(e,r){this.$message.error("文件上传失败，请稍后重试！"),this.ruleForm.resourcePdfUrl="",this.uploadList=[]},handleRemove:function(e){this.ruleForm.resourcePdfUrl=""},uploadChange:function(e,r){console.log(r),this.uploadList=r.slice(r.length-1)},beforeAvatarUpload:function(e){console.log(e);var r="pdf"==e.name.split(".")[e.name.split(".").length-1],t=e.size/1024/1024<100;return r||this.$message.error("上传文件只能是 PDF 格式!"),t||this.$message.error("上传文件大小不能超过 100MB!"),!(!r&&t)||(console.log(78787),this.uploadList=[],!1)},dlHandleAvatarSuccess:function(e,r,t){"SUCCESS"==e.state?this.ruleForm.resourceUrl=e.url:(this.$message.error("文件上传失败，请稍后重试！"),this.ruleForm.resourceUrl="",this.dlUploadList=[])},dlHandleError:function(e,r){this.$message.error("文件上传失败，请稍后重试！"),this.ruleForm.resourceUrl="",this.dlUploadList=[]},dlHandleRemove:function(e){this.ruleForm.resourceUrl=""},dlUploadChange:function(e,r){console.log(r),this.dlUploadList=r.slice(r.length-1)},dlBeforeAvatarUpload:function(e){console.log(e);var r=e.size/1024/1024<100;return r||this.$message.error("上传文件大小不能超过 100MB!"),!!r||(console.log(78787),this.uploadList=[],!1)}}},i={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"addAnnouncement",attrs:{id:"addAnnouncement"}},[t("fei-bread",[e._v("\n    资料下载\n    "),t("i",{staticClass:"el-icon-d-arrow-right"}),e._v(" "),t("span",{staticClass:"current-text"},[e._v("添加资料")])]),e._v(" "),t("el-card",{staticClass:"card"},[t("div",{staticClass:"card-div"},[t("p",{staticClass:"backPeony"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-back"},on:{click:e.backPeonyPage}},[e._v("返回上一级")])],1),e._v(" "),t("p",{staticStyle:{color:"red"}},[e._v("* 资料需上传中英对照版")]),e._v(" "),t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[t("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"资料标题",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),e._v(" "),t("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"资料英文标题",prop:"name_en"}},[t("el-input",{model:{value:e.ruleForm.name_en,callback:function(r){e.$set(e.ruleForm,"name_en",r)},expression:"ruleForm.name_en"}})],1),e._v(" "),t("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"资料描述",prop:"desc"}},[t("el-input",{model:{value:e.ruleForm.desc,callback:function(r){e.$set(e.ruleForm,"desc",r)},expression:"ruleForm.desc"}})],1),e._v(" "),t("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"资料英文描述",prop:"desc_en"}},[t("el-input",{model:{value:e.ruleForm.desc_en,callback:function(r){e.$set(e.ruleForm,"desc_en",r)},expression:"ruleForm.desc_en"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"下载资料上传",prop:"resourceUrl"}},[t("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.$global.baseUrl2+"/file/upload",headers:e.myHeaders,name:"upfile","file-list":e.dlUploadList,"on-success":e.dlHandleAvatarSuccess,"on-error":e.dlHandleError,"on-remove":e.dlHandleRemove,"before-upload":e.dlBeforeAvatarUpload,"on-change":e.dlUploadChange,multiple:!1}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("\n              将文件拖到此处，或\n              "),t("em",[e._v("点击上传")])])])],1),e._v(" "),t("el-form-item",{attrs:{label:"预览资料上传",prop:"resourcePdfUrl"}},[t("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.$global.baseUrl2+"/file/upload",headers:e.myHeaders,name:"upfile","file-list":e.uploadList,"on-success":e.handleAvatarSuccess,"on-error":e.handleError,"on-remove":e.handleRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.uploadChange,multiple:!1}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("\n              将文件拖到此处，或\n              "),t("em",[e._v("点击上传")])]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传pdf文件，且不超过100M")])])],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])],1)},staticRenderFns:[]};var u=t("VU/8")(n,i,!1,function(e){t("sxzk")},"data-v-0d968ae8",null);r.default=u.exports},bOdI:function(e,r,t){"use strict";r.__esModule=!0;var s,l=t("C4MV"),o=(s=l)&&s.__esModule?s:{default:s};r.default=function(e,r,t){return r in e?(0,o.default)(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}},sxzk:function(e,r){}});