webpackJsonp([24],{LmFJ:function(e,t){},l2E8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),s=a.n(o),i=(a("NYxO"),{name:"userManagement",data:function(){return{userType:"",ai:"",baseUrl:"",dialogShenhe:!1,shenheForm:{status:!0,textarea:""},downLoadAiZip:"",downLoadMsgZip:"",input:"",tableData:[],pageInfo:{pageNum:1,pageSize:10},totalSize:10,keyWords:"",options:[{value:"选项1",label:"全部用户"},{value:"true",label:"AI用户"},{value:"false",label:"人类用户"}],value:"",dialogEdit:!1,dialogAddUser:!1,Loading:!1,editForm:{ai:!0,aiPackage:"",name:"",nickName:"",occupation:"",organization:"",phone:"",sex:"",userId:0,userType:""},addForm:{ai:!0,email:"",name:"",nickName:"",occupation:"",organization:"",phone:"",password:"",userType:"user"},formLabelWidth:"50px",labelPosition:"right",aiHistoryId:0,isAI:!1,bathDelArr:[],editFormRule:{nickName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:30,message:"用户名字符在 1 到 30 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{min:1,max:30,message:"真实姓名在 1 到 30 个字符",trigger:"blur"}],occupation:[{required:!0,message:"请输入职业",trigger:"blur"},{min:1,max:30,message:"职业在 1 到 30 个字符",trigger:"blur"}],organization:[{required:!0,message:"请输入学习/工作单位",trigger:"blur"},{min:1,max:50,message:"学习个工作单位在 1 到 50 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入合法手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",min:1,max:100,message:"请输入合法邮箱",trigger:"blur"}]},addFormRule:{nickName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:30,message:"用户名字符在 1 到 30 个字符",trigger:"blur"}],ai:[{required:!0,message:"请选择用户类型",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:50,message:"密码内容在 3 到 50个字符",trigger:"blur"}],name:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{min:1,max:30,message:"真实姓名在 1 到 30 个字符",trigger:"blur"}],occupation:[{required:!0,message:"请输入职业",trigger:"blur"},{min:1,max:30,message:"职业在 1 到 30 个字符",trigger:"blur"}],organization:[{required:!0,message:"请输入学习工作单位",trigger:"blur"},{min:1,max:50,message:"学习个工作单位在 1 到 50 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入合法手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",min:1,max:100,message:"请输入合法邮箱",trigger:"blur"}]}}},computed:{},mounted:function(){this.getData();console.log(2)},methods:{getData:function(e){var t=this,a={keyWords:this.input,pageNum:this.pageInfo.pageNum,pageSize:this.pageInfo.pageSize};this.userType&&("ai"==this.userType?(this.ai=!0,a.ai=this.ai):"all"==this.userType?(console.log("3456"),a.ai=!1):(console.log("789"),a.ai=!1,a.userType=this.userType)),this.Loading=!0,this.$request.searchUserData(a).then(function(e){200==e.code?e.result?(t.tableData=e.result.content,t.totalSize=e.result.totalSize,console.log(e,"我是user的数据"),t.Loading=!1):(t.tableData=[],t.totalSize=0,t.Loading=!1):(t.Loading=!1,t.$message({showClose:!0,message:"未获取到数据！",type:"warning",duration:3e3}))}).catch(function(e){t.Loading=!1,t.$message({showClose:!0,message:"服务器出错哦！",type:"error",duration:3e3})})},handleEdit:function(e,t){this.dialogEdit=!0,this.isAI=t.ai,this.isAI,this.editForm=JSON.parse(s()(t))},handleDelete:function(e,t){var a=this;console.log("您要删除id为"+t.userId+"的用户"),this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$request.delUser({id:t.userId}).then(function(e){200==e.code?(a.$message({type:"success",message:"删除成功!"}),a.getData()):a.$message({type:"waring",message:"删除失败!"})}).catch(function(e){a.$message({type:"waring",message:"删除失败!"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.pageInfo.pageNum=1,this.getData()},handleCurrentChange:function(e){this.pageInfo.pageNum=e,this.getData()},searchByKeywords:function(){this.pageInfo.pageNum=1,this.getData()},editDialogConfirm:function(){var e=this;this.$refs.editForm.validate(function(t){t?(e.editForm.aiPackage="",e.editForm.certificatePackage="",e.$request.editUserData(e.editForm).then(function(t){200==t.code?(e.$message({showClose:!0,message:"编辑成功！",type:"success",duration:3e3}),e.getData(),e.dialogEdit=!1):(e.dialogEdit=!1,e.$message({showClose:!0,message:"编辑失败",type:"error",duration:3e3}))}).catch(function(t){e.dialogEdit=!1,e.$message({showClose:!0,message:"服务器出错哦！",type:"error",duration:3e3})})):e.$message({showClose:!0,message:"请检查您填写的信息是否有误！",type:"error",duration:3e3})})},addDialogConfirm:function(){var e=this;this.$refs.addForm.validate(function(t){t?e.$request.addUser(e.addForm).then(function(t){200==t.code?(e.$message({showClose:!0,message:"添加成功！",type:"success",duration:3e3}),e.getData(),e.dialogAddUser=!1):e.$message({showClose:!0,message:t.msg,type:"error",duration:3e3})}).catch(function(t){e.dialogAddUser=!1,e.$message({showClose:!0,message:"服务器出错哦！",type:"error",duration:3e3})}):e.$message({showClose:!0,message:"请检查您填写的信息是否有误！",type:"error",duration:3e3})})},closeDialogAddUser:function(e){this.dialogAddUser=!1,this.$refs[e].resetFields()},cancel:function(e){this.dialogAddUser=!1,this.$refs[e].resetFields()},updatecancel:function(e){this.dialogEdit=!1,this.$refs[e].resetFields()},selectRow:function(e){console.log(e),this.bathDelArr=e.map(function(e){return e.userId}),console.log(this.bathDelArr)},bathDel:function(){var e=this;this.$confirm("此操作将永久删除该批量用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$request.bathDelUser(e.bathDelArr).then(function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),e.getData()):e.$message({type:"error",message:"删除失败!"})}).catch(function(t){e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},aiOrputong:function(e){this.userType=e,this.getData()},handleLoad:function(e,t){t.aiPackage?(console.log(123),this.downLoadAiZip=this.$global.baseUrl2+t.aiPackage,window.location.href=this.downLoadAiZip):this.$message.error("未提交AI算法包！")},handleExamine:function(e,t){var a=this;this.dialogShenhe=!0,this.editForm=t,this.$request.getHistory({userId:t.userId,pageNum:1,pageSize:1}).then(function(e){console.log(e),0!=e.result.content.length?a.aiHistoryId=e.result.content[0].aiHistoryId:a.aiHistoryId=-1})},shenheDialogConfirm:function(){var e=this;this.shenheForm.status||""!=this.shenheForm.textarea?this.aiHistoryId<0?this.$message.warning("该AI用户未提交全部资料，无法进行审核！"):this.shenheForm.status?this.$request.approveAi({aiHistoryId:this.aiHistoryId,userId:this.editForm.userId}).then(function(t){console.log(t),200==t.code?(e.$message.success("审核成功！"),e.dialogShenhe=!1,e.getData()):e.$message.error("审核失败！")}).catch(function(t){e.$message.error("链接超时，请稍后重试！")}):this.$request.rejectAi({aiHistoryId:this.aiHistoryId,userId:this.editForm.userId,rejectReason:this.shenheForm.textarea}).then(function(t){console.log(t),200==t.code&&(e.$message.warning("审核成功！"),e.dialogShenhe=!1,e.getData())}):this.$message.warning("请输入未通过原因！")}}}),r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.Loading,expression:"Loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"userManagement",attrs:{id:"userManagement","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("fei-bread",[e._v("用户管理")]),e._v(" "),a("el-card",[a("div",{staticClass:"tool"},[a("div",{staticClass:"tool-left"},[a("el-button",{attrs:{type:"success ",icon:"el-icon-plus"},on:{click:function(t){e.dialogAddUser=!0}}},[e._v("新增用户")]),e._v(" "),a("el-button",{attrs:{type:"danger ",icon:"el-icon-delete"},on:{click:e.bathDel}},[e._v("批量删除")])],1),e._v(" "),a("div",{staticClass:"tool-right"},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.aiOrputong},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("el-option",{attrs:{label:"全部用户",value:"all"}}),e._v(" "),a("el-option",{attrs:{label:"AI用户",value:"ai"}}),e._v(" "),a("el-option",{attrs:{label:"普通用户",value:"user"}}),e._v(" "),a("el-option",{attrs:{label:"管理员",value:"admin"}})],1),e._v(" "),a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入关键字进行搜索"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-aim"},on:{click:e.searchByKeywords}},[e._v("查询")])],1)]),e._v(" "),a("el-table",{staticClass:"tableCon",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"","header-cell-style":{backgroundColor:"#F3F3F3",color:"#000"}},on:{"selection-change":e.selectRow}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"用户昵称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userHead",label:"用户头像"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.headerImg?a("img",{staticClass:"tableImg",attrs:{src:e.$global.baseUrl2+t.row.headerImg,alt:""}}):a("span",[e._v("暂无头像")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"联系方式","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"createDate",label:"创建时间","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"ai",label:"用户类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.ai?"AI用户":"admin"==t.row.userType?"管理员":"人类用户"))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"occupation",label:"职业"}}),e._v(" "),a("el-table-column",{attrs:{prop:"organization",label:"学习/工作单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.ai?"passed"==t.row.aiStatus?"审核通过":"rejected"==t.row.aiStatus?"审核未通过":"待审核":"-"))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"action",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),t.row.ai?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return e.handleLoad(t.$index,t.row)}}},[e._v("下载")]):e._e(),e._v(" "),t.row.ai?a("el-button",{attrs:{size:"mini",type:"primary",disabled:"passed"==t.row.aiStatus||"rejected"==t.row.aiStatus},on:{click:function(a){return e.handleExamine(t.$index,t.row)}}},[e._v("审核")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"paginationBlock"},[a("el-pagination",{attrs:{"current-page":e.pageInfo.pageNum,"page-sizes":[10,20,30,40],"page-size":e.pageInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogShenhe},on:{"update:visible":function(t){e.dialogShenhe=t}}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("审核AI信息")]),e._v(" "),a("el-form",{ref:"shenheForm",attrs:{model:e.shenheForm,"label-position":"right","label-width":"120px"}},[a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.shenheForm.status,callback:function(t){e.$set(e.shenheForm,"status",t)},expression:"shenheForm.status"}},[a("el-option",{attrs:{label:"审核通过",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"审核未通过",value:!1}})],1)],1),e._v(" "),e.shenheForm.status?e._e():a("el-form-item",{attrs:{label:"未通过原因"}},[a("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入内容"},model:{value:e.shenheForm.textarea,callback:function(t){e.$set(e.shenheForm,"textarea",t)},expression:"shenheForm.textarea"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogShenhe=!1}}},[e._v("取 消")]),e._v(" "),a("a",{staticClass:"el-button el-button--success",attrs:{type:"success",href:e.editForm.certificatePackage?e.$global.baseUrl2+e.editForm.certificatePackage:"javascripy:;"}},[e._v(e._s(e.editForm.certificatePackage?"下载审核材料":"未提交审核材料"))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.shenheDialogConfirm}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogEdit},on:{"update:visible":function(t){e.dialogEdit=t}}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("编辑用户信息")]),e._v(" "),a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRule,"label-position":"right","label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户昵称",prop:"nickName"}},[a("el-input",{attrs:{width:"50px",autocomplete:"off"},model:{value:e.editForm.nickName,callback:function(t){e.$set(e.editForm,"nickName",t)},expression:"editForm.nickName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系方式",prop:"phone"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职业",prop:"occupation"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.editForm.occupation,callback:function(t){e.$set(e.editForm,"occupation",t)},expression:"editForm.occupation"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"学习/工作单位",prop:"organization"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.editForm.organization,callback:function(t){e.$set(e.editForm,"organization",t)},expression:"editForm.organization"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户类型"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择状态"},model:{value:e.editForm.ai,callback:function(t){e.$set(e.editForm,"ai",t)},expression:"editForm.ai"}},[a("el-option",{attrs:{label:"AI用户",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"人类用户",value:!1}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户权限"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.editForm.userType,callback:function(t){e.$set(e.editForm,"userType",t)},expression:"editForm.userType"}},[a("el-option",{attrs:{label:"普通用户",value:"user"}}),e._v(" "),a("el-option",{attrs:{label:"管理员",value:"admin"}})],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.updatecancel("editForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.editDialogConfirm}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.dialogAddUser},on:{"update:visible":function(t){e.dialogAddUser=t},close:function(t){return e.closeDialogAddUser("addForm")}}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("新增用户")]),e._v(" "),a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRule,"label-position":"right","label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户昵称",prop:"nickName"}},[a("el-input",{attrs:{width:"50px",autocomplete:"off"},model:{value:e.addForm.nickName,callback:function(t){e.$set(e.addForm,"nickName",t)},expression:"addForm.nickName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系方式",prop:"phone"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职业",prop:"occupation"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.occupation,callback:function(t){e.$set(e.addForm,"occupation",t)},expression:"addForm.occupation"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"学习/工作单位",prop:"organization"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.organization,callback:function(t){e.$set(e.addForm,"organization",t)},expression:"addForm.organization"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户类型",prop:"ai"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.addForm.ai,callback:function(t){e.$set(e.addForm,"ai",t)},expression:"addForm.ai"}},[a("el-option",{attrs:{label:"AI用户",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"普通用户",value:!1}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel("addForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addDialogConfirm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(i,r,!1,function(e){a("LmFJ")},"data-v-b75a23ea",null);t.default=l.exports},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var o=a("FeBl"),s=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}}});