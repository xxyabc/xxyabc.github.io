webpackJsonp([20],{"4+Le":function(e,t){},dK9v:function(e,t){},mZWv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),i=a.n(o),s=a("1oBE"),r=Object(s.a)(),n={name:"editionManagement",data:function(){return{token:"",myHeaders:{token:r},input:"",tableData:[],tag:!1,pageInfo:{pageNum:1,pageSize:10},editForm:{audioName:"",audioMsg:""},editFormRule:{audioName:[{required:!0,message:"请输入音效名称",trigger:"blur"},{min:1,max:20,message:"用户名字符在 1 到 20 个字符",trigger:"blur"}],audioMsg:[{required:!0,message:"请输入描述",trigger:"blur"}]},submitData:null,fileList:[],totalSize:10,currentPage4:1,bathDelArr:[],dialogAddUser:!1}},mounted:function(){this.getData(),this.token=Object(s.a)()},methods:{getData:function(e){var t=this;this.Loading=!0,this.$request.getAudioList().then(function(e){200==e.code?(t.tableData=e.result,console.log(e),t.Loading=!1):(t.Loading=!1,t.$message({showClose:!0,message:"未获取到数据！",type:"warning",duration:3e3}))}).catch(function(e){t.Loading=!1,t.$message({showClose:!0,message:"服务器出错哦！",type:"error",duration:3e3})})},edit:function(e){this.dialogAddUser=!0,this.editForm=JSON.parse(i()(e)),this.fileList=[{name:this.editForm.audioPath,url:this.editForm.audioPath}]},handleAvatarSuccess:function(e,t){"SUCCESS"==e.state?this.editForm.audioPath=e.url:this.$message.error("上传失败，请稍后重试！")},handleError:function(e,t){this.$message.error("上传失败，请稍后重试！")},beforeAvatarUpload:function(e){console.log(e);var t="audio/mpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传音频只能是mp4格式!"),a||this.$message.error("上传头音频大小不能超过 2MB!"),t&&a},audioChange:function(e,t){this.fileList=t.slice(t.length-1)},addDialogConfirm:function(){var e=this;this.$refs.editForm.validate(function(t){t?(console.log(e.editForm),e.$request.updateAudio(e.editForm).then(function(t){200==t.code?(e.$message({showClose:!0,message:"添加成功！",type:"success",duration:3e3}),e.$refs.editForm.resetFields(),e.getData(),e.dialogAddUser=!1):(e.dialogAddUser=!1,e.$message({showClose:!0,message:"添加失败",type:"error",duration:3e3}))}).catch(function(t){e.dialogAddUser=!1,e.$message({showClose:!0,message:"服务器出错哦！",type:"error",duration:3e3})})):e.$message({showClose:!0,message:"请检查您填写的信息是否有误！",type:"error",duration:3e3})})},handleSelectionChange:function(e){this.bathDelArr=e,console.log(e)},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageInfo.pageSize=e,this.pageInfo.pageNum=1,this.tag||(this.input=""),this.getData()},handleCurrentChange:function(e){console.log("当前页: "+e),this.pageInfo.pageNum=e,this.tag||(this.input=""),this.getData()},bathDel:function(){var e=this;0!=this.bathDelArr.length?this.$confirm("此操作将永久删除版本信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.bathDelArr.forEach(function(e){t.push(e.versionId)}),console.log(t),e.$request.bathDelSystem(t).then(function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),e.getData()):e.$message({type:"error",message:"删除失败!"})}).catch(function(t){e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({message:"请选需要删除的版本",type:"warning",duration:1e3})},searchByKeywords:function(){this.pageInfo.pageNum=1,this.tag=!0,this.getData()},cancel:function(e){this.$refs[e].resetFields(),this.dialogAddUser=!1,this.fileList=[]},search:function(){this.tag=!1}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userManagement",attrs:{id:"userManagement"}},[a("fei-bread",[e._v("音效管理")]),e._v(" "),a("el-card",[a("el-table",{staticClass:"tableCon",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"","header-cell-style":{backgroundColor:"#F3F3F3",color:"#000"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"audioName",label:"音效名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"audioMsg",label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"action",label:"操作",width:"330px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),a("a",{staticClass:"el-button el-button--default el-button--mini",attrs:{href:e.$global.baseUrl2+t.row.audioPath}},[e._v("下载")])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.dialogAddUser},on:{"update:visible":function(t){e.dialogAddUser=t},closed:function(t){return e.cancel("editForm")}}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("编辑音频文件")]),e._v(" "),a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRule,"label-position":"right","label-width":"120px"}},[a("el-form-item",{attrs:{label:"音效名称",prop:"audioName"}},[a("el-input",{attrs:{width:"50px",autocomplete:"off"},model:{value:e.editForm.audioName,callback:function(t){e.$set(e.editForm,"audioName",t)},expression:"editForm.audioName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"音效描述",prop:"audioMsg"}},[a("el-input",{attrs:{width:"50px",autocomplete:"off"},model:{value:e.editForm.audioMsg,callback:function(t){e.$set(e.editForm,"audioMsg",t)},expression:"editForm.audioMsg"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"音频文件",prop:"coverImg"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.$global.baseUrl2+"/file/upload",headers:e.myHeaders,name:"upfile","file-list":e.fileList,"on-success":e.handleAvatarSuccess,"on-error":e.handleError,"before-upload":e.beforeAvatarUpload,"on-change":e.audioChange}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("\n            将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n            只能上传mp3文件，且不超过500kb\n          ")])])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel("editForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addDialogConfirm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(n,l,!1,function(e){a("dK9v"),a("4+Le")},"data-v-4ab66753",null);t.default=d.exports},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var o=a("FeBl"),i=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}}});